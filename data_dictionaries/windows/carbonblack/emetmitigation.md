# ingress.event.emetmitigation (EMET Mitigation)

## Description

Microsoft EMET has killed a process on an endpoint monitored by Carbon Black.

[Carbon Black Developer Docs](https://developer.carbonblack.com/reference/enterprise-response/event-forwarder/event-schema/#ingress-event-emetmitigation-emet-mitigation)

## Event Log Illustration & Event XML
```
{
    "blocked": true,
    "cb_server": "cbserver",
    "computer_name": "JASON-WIN81-VM",
    "emet_timestamp": 130949318600000000,
    "event_type": "emet_mitigation",
    "link_process": "https://cbtests/#analyze/00000001-0000-0d10-01d1-39b621f894f9/1",
    "link_sensor": "https://cbtests/#/host/1",
    "log_id": 1032,
    "log_message": "EMET detected EAF mitigation and will close the application: EMET_Test64.exe\r\n\r\nEAF check failed:\n  Application \t: C:\\Users\\dan\\Desktop\\EMET_TEST\\EMET_Test64.exe\n  User Name \t: DANWIN764\\dan\n  Session ID \t: 1\n  PID \t\t: 0xD10 (3344)\n  TID \t\t: 0xDB4 (3508)\n  Module \t: N/A\n  Mod Base \t: 0x0000000000000000\n  Mod Address \t: 0x000000000297000D\n  Mem Address \t: 0x0000000000000000\n\r\n",
    "md5": "053EEEE1ABAE53F044F1E386E22AE525",
    "mitigation": "Eaf",
    "pid": 3344,
    "process_guid": "00000001-0000-0d10-01d1-39b621f894f9",
    "sensor_id": 1,
    "timestamp": 1450458260,
    "type": "ingress.event.emetmitigation"
}
```

## Data Dictionary
|	Standard Name	|	Field Name	|	Type	|	Description	|	Sample Value	|
|	-------------	|	----------	|	----	|	-----------	|	------------	|
|		|	blocked	|	BOOLEAN	|	boolean value describing if the action was successfully blocked by EMET	|	true	|
|		|	cb_server	|	TEXT	|	Used to distinguish between multiple Cb Response servers. Set this in the “server_name” option of cb-event-forwarder.ini.	|	cbserver	|
|		|	computer_name	|	TEXT	|	hostname of the sensor	|	JASON-WIN81-VM	|
|		|	emet_timestamp	|	BIGINT	|	timestamp of EMET event represented by a 64-bit Windows FILETIME	|	130949318600000000	|
|		|	event_type	|	TEXT	|	type of event	|	filemod	|
|		|	link_process	|	TEXT	|	Deep link to Cb Response UI for process	|	https://cbtests/#analyze/00000001-0000-0d10-01d1-39b621f894f9/1	|
|		|	link_sensor	|	TEXT	|	Deep link to Cb Response UI for sensor	|	https://cbtests/#/host/1	|
|		|	log_id	|	INTEGER	|	EMET log ID associated with this emetmitigation event	|	1032	|
|		|	log_message	|	TEXT	|	The full log message generated by EMET	|	EMET detected EAF mitigation and will close the application: EMET_Test64.exe\r\n\r\nEAF check failed:\n  Application \t: C:\\Users\\dan\\Desktop\\EMET_TEST\\EMET_Test64.exe\n  User Name \t: DANWIN764\\dan\n  Session ID \t: 1\n  PID \t\t: 0xD10 (3344)\n  TID \t\t: 0xDB4 (3508)\n  Module \t: N/A\n  Mod Base \t: 0x0000000000000000\n  Mod Address \t: 0x000000000297000D\n  Mem Address \t: 0x0000000000000000\n\r\n	|
|		|	md5	|	TEXT	|	md5 of process_guid executable image	|	7A2870C2A8283B3630BF7670D0362B94	|
|		|	mitigation	|	TEXT	|	The type of EMET mitigation performed to block the operation. Possible values are Dep, Sehop, Asr, Aslr, NullPage, HeapSpray, MandatoryAslr, Eaf, EafPlus, BottomUpAslr, LoadLibrary, MemoryProtection, SimulateExecFlow, StackPivot, CallerChecks, BannedFunctions, DeepHooks, AntiDetours.	|	Eaf	|
|		|	pid	|	INTEGER	|	Endpoint OS Process id of process that generated the emetmitigation event	|	3344	|
|		|	process_guid	|	TEXT	|	Process GUID of offending process	|	00000001-0000-0d10-01d1-39b621f894f9	|
|		|	sensor_id	|	INTEGER	|	sensor ID of associated sensor	|	1	|
|		|	timestamp	|	INTEGER	|	Endpoint timestamp of this event since epoch	|	1450458260	|
|		|	type	|	TEXT	|	The full type of event	|	ingress.event.emetmitigation	|