
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Domain vs FQDN vs Host Name Implementation &#8212; The OSSEM Project</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://ossemproject.com/cdm/guidelines/domain_or_hostname_or_fqdn.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Entities" href="../entities/intro.html" />
    <link rel="prev" title="Data Types" href="data_types.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The OSSEM Project</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Data Dictionaries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../dd/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../dd/guidelines/intro.html">
   Guidelines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../dd/guidelines/authoring_data_dictionaries.html">
     Data Dictionary Authoring Guide
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Common Data Model
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Guidelines
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="entity_structure.html">
     Entity Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="table_structure.html">
     Table Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data_types.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Domain vs FQDN vs Host Name Implementation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../entities/intro.html">
   Entities
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/alert.html">
     alert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/any.html">
     any
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/certificate.html">
     certificate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/cloud.html">
     cloud
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/destination.html">
     destination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/destination_nat.html">
     destination_nat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/device.html">
     device
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/dns.html">
     dns
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/etl.html">
     etl
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/event.html">
     event
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/file.html">
     file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/geo.html">
     geo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/group.html">
     group
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/hash.html">
     hash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/http.html">
     http
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/ip.html">
     ip
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/kerberos.html">
     kerberos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/logon.html">
     logon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/mac.html">
     mac
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/meta.html">
     meta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/module.html">
     module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/network.html">
     network
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/pipe.html">
     pipe
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/port.html">
     port
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/process.html">
     process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/registry.html">
     registry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/rule.html">
     rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/source.html">
     source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/source_nat.html">
     source_nat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/target.html">
     target
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/threat.html">
     threat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/tls.html">
     tls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/url.html">
     url
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/user.html">
     user
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../entities/user_agent.html">
     user_agent
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tables/intro.html">
   Tables
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tables/network_session.html">
     network_session
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Detection Model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../dm/intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dm/ossem_relationships_to_events.html">
   Relationships to Events
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../dm/mitre_attack/intro.html">
   MITRE ATT&amp;CK
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../dm/mitre_attack/attack_techniques_to_events.html">
     ATT&amp;CK Techniques to Security Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../dm/mitre_attack/attack_ds_events_mappings.html">
     ATT&amp;CK DS Event Mappings
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/cdm/guidelines/domain_or_hostname_or_fqdn.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/OTRF/OSSEM"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/OTRF/OSSEM/issues/new?title=Issue%20on%20page%20%2Fcdm/guidelines/domain_or_hostname_or_fqdn.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/OTRF/OSSEM/edit/master/docs/cdm/guidelines/domain_or_hostname_or_fqdn.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-definitions">
   Common Definitions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fqdn">
     FQDN
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hostname">
     Hostname
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#domain">
     Domain
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples-of-ambiguity">
   Examples of Ambiguity
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#background">
     Background
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scenario-1">
       Scenario 1
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#scenario-1-problem-framing">
         Scenario 1 Problem Framing
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scenario-2">
       Scenario 2
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#scenario-2-problem-framing">
         Scenario 2 Problem Framing
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implementation-outline">
     Implementation Outline
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       FQDN
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Hostname
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Domain
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implementation-field-examples">
       Implementation Field Examples:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implementation-examples">
     Implementation Examples
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="domain-vs-fqdn-vs-host-name-implementation">
<h1>Domain vs FQDN vs Host Name Implementation<a class="headerlink" href="#domain-vs-fqdn-vs-host-name-implementation" title="Permalink to this headline">¶</a></h1>
<p>This guide will show you how to label FQDNs, Domains, and Hostnames (for both source/destination) commonly found in logs for Endpoint, DNS, HTTP, SSL, SMB, Radius, URLs, etc…<br />
However, there is an incredible amount of ambiguity, in logging, regarding the values for a Domain, Hostname, and FQDN (fully qualified domain name).</p>
<p>Therefore, we are going to (try) to clear up this ambiguity in order to properly implement a schema.  The order of this guideline is as follows (skip to <a class="reference external" href="./domain_or_hostname_or_fqdn.md#Implementation">Implementation</a> if you have already read the definitions and problem framing)</p>
<ol class="simple">
<li><p>Explain the <a class="reference external" href="./domain_or_hostname_or_fqdn.md#Common-Definitions">Common Definitions</a>, apart from this schema, for these three terms.</p></li>
<li><p>Show some <a class="reference external" href="./domain_or_hostname_or_fqdn.md#Examples-of-Ambiguity">examples</a> that cause ambiguity in these common definitions.</p></li>
<li><p>Outline and guideline for how to perform the <a class="reference external" href="./domain_or_hostname_or_fqdn.md#Implementation">Implementation</a> for this schema</p></li>
</ol>
<div class="section" id="common-definitions">
<h2>Common Definitions<a class="headerlink" href="#common-definitions" title="Permalink to this headline">¶</a></h2>
<p>The following are the most common definitions for a Domain, Hostname, and FQDN. We will use the example value <code class="docutils literal notranslate"><span class="pre">bob-berto-pc.bigwheel.corporation.local</span></code> as the example to visualize the definitions.</p>
<div class="section" id="fqdn">
<h3>FQDN<a class="headerlink" href="#fqdn" title="Permalink to this headline">¶</a></h3>
<p>The absolute (entire) value of the DNS hierarchy from the lowest level to the top level domain (TLD). Consists of the Hostname and Domain. This is best defined in <a class="reference external" href="https://en.wikipedia.org/w/index.php?title=Fully_qualified_domain_name&amp;oldid=911195384#Syntax">this Wikipedia</a> article on FQDN.<br />
example FQDN value = <code class="docutils literal notranslate"><span class="pre">bob-berto-pc.bigwheel.corporation.local</span></code></p>
</div>
<div class="section" id="hostname">
<h3>Hostname<a class="headerlink" href="#hostname" title="Permalink to this headline">¶</a></h3>
<p>The name of a host, device, node, or entity that is separate from the FQDN and Domain. Think of this in the context of running the “hostname” command.<br />
example Hostname value = <code class="docutils literal notranslate"><span class="pre">bob-berto-pc</span></code></p>
</div>
<div class="section" id="domain">
<h3>Domain<a class="headerlink" href="#domain" title="Permalink to this headline">¶</a></h3>
<p>The (DNS) hierarchy that encompasses multiple hosts (ie: a Windows Active Directory environment).<br />
example Domain value = <code class="docutils literal notranslate"><span class="pre">bigwheel.corporation.local</span></code></p>
</div>
</div>
<div class="section" id="examples-of-ambiguity">
<h2>Examples of Ambiguity<a class="headerlink" href="#examples-of-ambiguity" title="Permalink to this headline">¶</a></h2>
<p>Lets use some common examples that will (hopefully) begin to illustrate the ambiguity in being able to determine what is “truly” the FQDN, Hostname, or Domain from a logging perspective.</p>
<div class="section" id="background">
<h3>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Organization owns <code class="docutils literal notranslate"><span class="pre">corporation.local</span></code></p></li>
<li><p>Active Directory forest at <code class="docutils literal notranslate"><span class="pre">bigwheel.corporation.local</span></code></p></li>
<li><p>Another AD environment that is a sub domain of their AD forest, and is located at <code class="docutils literal notranslate"><span class="pre">finance-group.bigwheel.corporation.local</span></code></p></li>
<li><p>External web server at <code class="docutils literal notranslate"><span class="pre">www.corporation.local</span></code></p></li>
<li><p>Internal ISS server hosting a Wiki at <code class="docutils literal notranslate"><span class="pre">wiki.bigwheel.corporation.local</span></code></p></li>
<li><p>You have logging for both endpoint, the IIS sever, DNS, HTTP, SSL, Proxy, and other network logs.</p></li>
</ul>
<div class="section" id="scenario-1">
<h4>Scenario 1<a class="headerlink" href="#scenario-1" title="Permalink to this headline">¶</a></h4>
<p>HTTP request for <code class="docutils literal notranslate"><span class="pre">wiki.bigwheel.corporation.local</span></code> was made by an endpoint. You now have the following log sources and their field name for this value:</p>
<ol class="simple">
<li><p>Proxy log defining the field as <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p></li>
<li><p>Endpoint log defining the field as <code class="docutils literal notranslate"><span class="pre">DestinationDomain</span></code></p></li>
<li><p>DNS log defining the field as <code class="docutils literal notranslate"><span class="pre">dns_query</span></code></p></li>
<li><p>IIS web server log defining two fields, <strong>a)</strong> <code class="docutils literal notranslate"><span class="pre">destination_hostname</span></code> with the value <code class="docutils literal notranslate"><span class="pre">wiki</span></code> and <strong>b)</strong> <code class="docutils literal notranslate"><span class="pre">destination_domain</span></code> with the value <code class="docutils literal notranslate"><span class="pre">bigwheel.corporation.local</span></code></p></li>
</ol>
<div class="section" id="scenario-1-problem-framing">
<h5>Scenario 1 Problem Framing<a class="headerlink" href="#scenario-1-problem-framing" title="Permalink to this headline">¶</a></h5>
<p>Now, because you have 4 logs that you can (and should definitely) pivot between related to this 1 HTTP request, you set out to define these fields into a common format in order to accomplish this pivoting</p>
<ul class="simple">
<li><p>The proxy log defining the field as <code class="docutils literal notranslate"><span class="pre">hostname</span></code> is incorrect, we know that the hostname is actually <code class="docutils literal notranslate"><span class="pre">wiki</span></code></p></li>
<li><p>The endpoint log using the verbiage <code class="docutils literal notranslate"><span class="pre">DestinationDomain</span></code> is incorrect, we know that <code class="docutils literal notranslate"><span class="pre">Domain</span></code> is actually <code class="docutils literal notranslate"><span class="pre">bigwheel.corporation.local</span></code></p></li>
<li><p>The DNS log, at least took a passive stance and just labeled the value specific to the DNS application - however we are left with being able to pivot from this DNS query to the other log sources (if we don’t change it)</p></li>
<li><p>The IIS log correctly labels the fields. However, this is a very critical piece that in many scenarios you may not have this level of intimate knowledge into the environment. The endpoint log that belongs to the same (AD) domain as the web server, had no knowledge of the destination’s hostname or (AD) domain! Also, you may be just placing a network sensor for incident response.</p></li>
</ul>
</div>
</div>
<div class="section" id="scenario-2">
<h4>Scenario 2<a class="headerlink" href="#scenario-2" title="Permalink to this headline">¶</a></h4>
<p>Endpoint makes an HTTP request to an external IP (Destination IP) with the HTTP Host header set via the command line in cURL of <code class="docutils literal notranslate"><span class="pre">mwi2xha9lpqn41lo</span></code>. For example, the command <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">--header</span> <span class="pre">&quot;Host:</span> <span class="pre">mwi2xha9lpqn41lo&quot;</span> <span class="pre">http://8.8.8.8/</span></code> was used. You now have the following log sources and their field name for this value:</p>
<ol class="simple">
<li><p>Proxy log defining the field as <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p></li>
<li><p>Endpoint log defining the field as <code class="docutils literal notranslate"><span class="pre">DestinationDomain</span></code></p></li>
</ol>
<div class="section" id="scenario-2-problem-framing">
<h5>Scenario 2 Problem Framing<a class="headerlink" href="#scenario-2-problem-framing" title="Permalink to this headline">¶</a></h5>
<p>Now, because the connection was direct to an IP, we don’t have a DNS log but we have two log sources with the same value that we would want to pivot on.</p>
<ul class="simple">
<li><p>The value has no clear indication of whether its a FQDN, Hostname, or Domain. It is just random characters and doesn’t even include any TLD. Whether this is malicious or not, is irrelevant - this sort of things happens consistently whether by mistake or malicious intent and for the purpose of this guideline - we are interested in normalizing fields into a schema..before we take the next step of determining the intent of malicious, mistake, or bad practice/hygiene.</p></li>
<li><p>Also, lets say the Host header wasn’t set and instead the command , and instead the command <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">http://8.8.8.8/</span></code> was used. You now have two fields with the value <code class="docutils literal notranslate"><span class="pre">8.8.8.8</span></code> (outside of the Destination IP). Again, this is definitely not a FQDN, Hostname, or Domain - and you don’t want to delete the field either.</p></li>
</ul>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>Due to the ambiguity that will happen in log sources and not being able to, always let alone the majority of the time, distinguish the FQDN vs the Domain vs the Hostname as well as the confusion caused by log source’s field names - we will define definitions in order that this delineation is NOT necessary between the three. Also, provide specific examples of log sources and what to call the fields, in order to even further clear any ambiguity.</p>
<p>These apply to both source and destination FQDNs, Domains, and hostnames. Therefore, if you only see destination verbiage below - just replace that with source for the applicable log scenario.</p>
<div class="section" id="implementation-outline">
<h3>Implementation Outline<a class="headerlink" href="#implementation-outline" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4>FQDN<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>This is an optional field. Because there are many scenarios (as briefly outlined above) where one can NOT determine the true FQDN, we will leave this field as defined but should only be used if the log source has intimate knowledge that this is in fact the FQDN.</p>
</div>
<div class="section" id="id2">
<h4>Hostname<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>This field should always exist if there is some sort of domain, FQDN, or hostname in the log/event.</p>
</div>
<div class="section" id="id3">
<h4>Domain<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>This field is optional. Because there are many scenarios (as briefly outlined above) where one can NOT determine the true domain, we will leave this field as defined but should only be used if the log source has intimate knowledge that this is in fact the domain.</p>
</div>
<div class="section" id="implementation-field-examples">
<h4>Implementation Field Examples:<a class="headerlink" href="#implementation-field-examples" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst_domain</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_host_name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_domain</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_fqdn</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="implementation-examples">
<h3>Implementation Examples<a class="headerlink" href="#implementation-examples" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Sysmon <a class="reference external" href="https://github.com/OTRF/OSSEM/blob/master/data_dictionaries/windows/sysmon/events/event-3.md">EventID:3 network connection event log</a> field for <code class="docutils literal notranslate"><span class="pre">DestinationHostName</span></code> should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
<li><p>HTTP or Proxy or web server application logs (ie: IIS, Apache, NGINX, etc…), with the hostname/domain (also known as the HTTP Host header) should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code><br />
this would include:</p>
<ul class="simple">
<li><p>Zeek HTTP field <code class="docutils literal notranslate"><span class="pre">host</span></code></p></li>
<li><p>Suricata HTTP field <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p></li>
<li><p>NGINX field <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p></li>
<li><p>IIS field <code class="docutils literal notranslate"><span class="pre">vhost</span></code></p></li>
</ul>
</li>
<li><p>TLS/SSL server name (SNI) should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p>
<ul class="simple">
<li><p>Zeek SSL field <code class="docutils literal notranslate"><span class="pre">server_name</span></code></p></li>
<li><p>Suricata TLS field <code class="docutils literal notranslate"><span class="pre">sni</span></code></p></li>
<li><p>NGINX field <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p></li>
<li><p>IIS field <code class="docutils literal notranslate"><span class="pre">vhost</span></code></p></li>
</ul>
</li>
<li><p>Kerberos service name should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
<li><p>Sysmon <a class="reference external" href="https://github.com/OTRF/OSSEM/blob/master/data_dictionaries/windows/sysmon/events/event-22.md">EventID:22 dns query event log</a> field for <code class="docutils literal notranslate"><span class="pre">QueryName</span></code> should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
<li><p>DNS query name field should be set as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p>
<ul class="simple">
<li><p>Zeek DNS field <code class="docutils literal notranslate"><span class="pre">query</span></code></p></li>
<li><p>Suricata DNS field <code class="docutils literal notranslate"><span class="pre">rrname</span></code></p></li>
</ul>
</li>
<li><p>For events/logs with URLs or URIs and the HTTP Host header (option 2) doesn’t exist, parse the hostname/domain portion out of the URL.<br />
For example:</p>
<ul class="simple">
<li><p>Zeek or Suricata HTTP log, skip this because it is defined in option 2</p></li>
<li><p>PaloAlto Threat log using the field <code class="docutils literal notranslate"><span class="pre">URL/Filename</span></code> field as <a class="reference external" href="https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/monitoring/use-syslog-for-monitoring/syslog-field-descriptions.html">outlined here</a> , after first renaming to <code class="docutils literal notranslate"><span class="pre">url.original</span></code> as defined in <a class="reference external" href="https://github.com/OTRF/OSSEM/blob/master/common_information_model/entities/url.md">URL Schema</a>, you would parse the domain/host out of this field and then set it as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
<li><p>RDP client/source name should be set as  <code class="docutils literal notranslate"><span class="pre">src_host_name</span></code></p></li>
<li><p>Endpoint (ie: Windows/Linux) logs that do <strong>NOT</strong> apply to the following:<br />
a) defined in the use cases above<br />
b) already defined in <a class="reference external" href="https://github.com/OTRF/OSSEM/tree/master/data_dictionaries">data dictionaries</a> (ex: <a class="reference external" href="https://github.com/OTRF/OSSEM/blob/master/data_dictionaries/windows/etw-providers/Microsoft-Windows-Security-Auditing/events/event-4768.md">Windows Kerberos EventID:4768</a>, <a class="reference external" href="https://github.com/OTRF/OSSEM/blob/master/data_dictionaries/windows/etw-providers/Microsoft-Windows-Security-Auditing/events/event-4624_v2.md">Windows Logon EventID:4624</a>)<br />
c) logically fit into Target or and are NOT</p>
<ol class="simple">
<li><p>FQDN and Domain values exist.</p>
<ul class="simple">
<li><p>Set the field for the FQDN value as <code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code></p></li>
<li><p>Copy the value for <code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code> into the field <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
<li><p>Set the field for the Domain value as <code class="docutils literal notranslate"><span class="pre">dst_domain</span></code></p></li>
</ul>
</li>
<li><p>FQDN and Hostname and Domain values exist</p>
<ul class="simple">
<li><p>Set the field for the FQDN value as <code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code></p></li>
<li><p>Set the field for Domain value as <code class="docutils literal notranslate"><span class="pre">dst_domain</span></code></p></li>
<li><p>Set the field for the Hostname value as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
<li><p>Hostname and Domain values exist</p>
<ul class="simple">
<li><p>Set the field for the Domain value as <code class="docutils literal notranslate"><span class="pre">dst_domain</span></code></p></li>
<li><p>Set the field for the Hostname value as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
<li><p>Hostname value only exists</p>
<ul class="simple">
<li><p>Set the field for the Hostname value as <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
<li><p>Domain value only exists</p>
<ul class="simple">
<li><p>Set the field for the Domain value as <code class="docutils literal notranslate"><span class="pre">dst_domain</span></code></p></li>
<li><p>Copy the value for <code class="docutils literal notranslate"><span class="pre">dst_domain</span></code> into the field <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
<li><p>FQDN value only exists</p>
<ul class="simple">
<li><p>Set the field for the FQDN value as <code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code></p></li>
<li><p>Copy the value for <code class="docutils literal notranslate"><span class="pre">dst_fqdn</span></code> into the field <code class="docutils literal notranslate"><span class="pre">dst_host_name</span></code></p></li>
</ul>
</li>
</ol>
</li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "OTRF/OSSEM",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./cdm/guidelines"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="data_types.html" title="previous page">Data Types</a>
    <a class='right-next' id="next-link" href="../entities/intro.html" title="next page">Entities</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Roberto Rodriguez @Cyb3rWard0g<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>